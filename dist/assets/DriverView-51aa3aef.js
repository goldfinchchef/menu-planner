import{r,a as ss,j as e}from"./index-4baa199c.js";import{C as Ie,g as Ee,S as Le,h as ts,F as ls}from"./index-93416efa.js";import{c as Me,T as V,A as ye,M as de,P as ie,a as pe,C as Be}from"./truck-139681aa.js";import{U as Te}from"./user-33c7d36d.js";import{H as $e}from"./home-124d23bd.js";import{C as Fe,a as as}from"./clock-291e28e6.js";const Ue=Me("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),_e=Me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ce="goldfinchChefData";function rs(){const[b,C]=r.useState([]),[y,h]=r.useState([]),[D,M]=r.useState([]),[B,q]=r.useState([]),[R,U]=r.useState([]),[J,W]=r.useState([]),[me,Q]=r.useState({}),[X,ee]=r.useState({}),[d,_]=r.useState(!1);r.useEffect(()=>{const n=()=>{const j=localStorage.getItem(ce);if(j)try{const c=JSON.parse(j);c.drivers&&C(c.drivers),c.clients&&h(c.clients),c.readyForDelivery&&M(c.readyForDelivery),c.deliveryLog&&q(c.deliveryLog),c.orderHistory&&U(c.orderHistory),c.menuItems&&W(c.menuItems),c.savedRoutes&&Q(c.savedRoutes),c.clientPortalData&&ee(c.clientPortalData)}catch(c){console.error("Error loading saved data:",c)}_(!0)};n();const u=j=>{j.key===ce&&n()};return window.addEventListener("storage",u),()=>window.removeEventListener("storage",u)},[]);const N=r.useCallback(n=>{const u=localStorage.getItem(ce);let j={};if(u)try{j=JSON.parse(u)}catch(P){console.error("Error parsing saved data:",P)}const c={...j,...n,lastSaved:new Date().toISOString()};localStorage.setItem(ce,JSON.stringify(c))},[]),se=r.useCallback(n=>{q(n),N({deliveryLog:n})},[N]),Ne=r.useCallback(n=>{M(n),N({readyForDelivery:n})},[N]),ue=r.useCallback(n=>{U(n),N({orderHistory:n})},[N]),I=r.useCallback(n=>b.find(u=>u.accessCode===n),[b]),te=r.useCallback(n=>b.find(u=>u.name===n),[b]);return{drivers:b,clients:y,readyForDelivery:D,deliveryLog:B,orderHistory:R,menuItems:J,savedRoutes:me,clientPortalData:X,isLoaded:d,updateDeliveryLog:se,updateReadyForDelivery:Ne,updateOrderHistory:ue,authenticateDriver:I,getDriverByName:te}}const i={HAND:"hand",PORCH:"porch"},w={DELIVERED:{key:"delivered",label:"Delivered",color:"#22c55e",icon:pe},READY:{key:"ready",label:"Ready",color:"#f59e0b",icon:V},IN_KDS:{key:"kds",label:"In Kitchen",color:"#3b82f6",icon:Be},PENDING:{key:"pending",label:"Menu Pending",color:"#6b7280",icon:ls},NONE:{key:"none",label:"No Menu",color:"#9ca3af",icon:as}};function xs(){var Ae,He;const[b]=ss(),{clients:C,readyForDelivery:y,deliveryLog:h,orderHistory:D,menuItems:M,savedRoutes:B,clientPortalData:q,isLoaded:R,updateDeliveryLog:U,updateReadyForDelivery:J,updateOrderHistory:W,authenticateDriver:me,getDriverByName:Q}=rs(),[X,ee]=r.useState(""),[d,_]=r.useState(null),[N,se]=r.useState(""),[Ne,ue]=r.useState(!1);r.useEffect(()=>{if(R&&!d){const s=b.get("admin_driver");if(s){const t=Q(s);t&&(_(t),ue(!0))}}},[R,b,d,Q]);const[I,te]=r.useState(0),[n,u]=r.useState(i.HAND),[j,c]=r.useState(null),[P,xe]=r.useState(null),[k,le]=r.useState(!1),[je,z]=r.useState(!1),[S,K]=r.useState(""),[ae,E]=r.useState(""),[Ke,Y]=r.useState(!1),[ve,re]=r.useState(!1),[v,ne]=r.useState([]),[we,oe]=r.useState(!1);r.useState(!1);const[Ye,ns]=r.useState(null),[p,he]=r.useState(null),G=r.useRef(null),g=new Date().toISOString().split("T")[0],L=Ye||g,Ce=L!==g,Ge=(s,t)=>h.some(l=>l.clientName===s&&l.date===t)?w.DELIVERED:y.some(l=>l.clientName===s&&l.date===t)?w.READY:M.some(l=>l.clientName===s&&l.approved&&l.date===t)?w.IN_KDS:M.some(l=>l.clientName===s&&!l.approved&&l.date===t)?w.PENDING:w.NONE,De=s=>{const t=new Date(s+"T12:00:00");return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]},ke=(s,t)=>{var m,o;if(!s||s.status!=="active"||s.pickup)return!1;const l=De(t);if(s.deliveryDay===l||(m=s.deliveryDates)!=null&&m.includes(t))return!0;const a=q[s.name];return!!((o=a==null?void 0:a.selectedDates)!=null&&o.includes(t))},Ze=()=>{if(!d)return[];const s=[],t=new Date(g);for(let l=0;l<14;l++){const a=new Date(t);a.setDate(t.getDate()+l);const m=a.toISOString().split("T")[0];C.some(x=>x.zone===d.zone&&ke(x,m))&&s.push(m)}return s},qe=()=>d?y.filter(s=>{const t=C.find(l=>l.name===s.clientName);return t&&t.zone===d.zone&&!t.pickup}).map(s=>{const t=C.find(a=>a.name===s.clientName),l=h.some(a=>a.clientName===s.clientName&&a.date===s.date);return{...s,displayName:(t==null?void 0:t.displayName)||s.clientName,address:(t==null?void 0:t.address)||"",zone:t==null?void 0:t.zone,isDelivered:l}}).filter(s=>!s.isDelivered).sort((s,t)=>new Date(s.date)-new Date(t.date)):[];Ze();const T=qe(),Se=s=>{var m;if(!d)return[];const t=C.filter(o=>o.zone===d.zone&&ke(o,s)).map(o=>{const x=Ge(o.name,s),f=y.filter(H=>H.clientName===o.name&&H.date===s);return{clientName:o.name,displayName:o.displayName||o.name,address:o.address||"",orders:f,zone:o.zone,date:s,status:x.key,statusInfo:x,isReady:x.key==="ready",isDelivered:x.key==="delivered"}}),l=`${s}-${d.zone}`,a=B==null?void 0:B[l];if(((m=a==null?void 0:a.stops)==null?void 0:m.length)>0){const o=[],x=new Set;return a.stops.forEach(f=>{const H=t.find(es=>es.clientName===f.clientName);H&&!x.has(H.clientName)&&(o.push(H),x.add(H.clientName))}),t.forEach(f=>{x.has(f.clientName)||o.push(f)}),o}return t},Re=s=>Se(s).filter(t=>t.isReady),$=Se(L),O=Re(L),Pe=Re(g),Z=O.filter(s=>!v.includes(s.clientName)&&!s.isDelivered),A=Z[I],Je=s=>h.some(t=>t.date===g&&t.clientName===s);r.useEffect(()=>{if(d&&R&&!Ce){const s=Pe.filter(t=>Je(t.clientName)).map(t=>t.clientName);ne(s)}},[d,R,Pe.length,Ce]),r.useEffect(()=>{d&&O.length>0&&Z.length===0&&oe(!0)},[d,O.length,Z.length]);const We=s=>{s.preventDefault();const t=me(X);t?(_(t),se("")):se("Invalid access code")},ge=()=>{_(null),ee(""),te(0),ne([]),oe(!1),F()},F=()=>{u(i.HAND),c(null),xe(null),le(!1),K(""),E(""),z(!1)},ze=s=>{const t=s.target.files[0];if(t){c(t);const l=new FileReader;l.onloadend=()=>{xe(l.result)},l.readAsDataURL(t)}},fe=(s=null,t="")=>{const l=p||A;if(!l)return;const a=l.date||g;if(n===i.PORCH&&!j&&!s){alert("Photo is required for porch drops");return}if(s==="Other"&&!t.trim()){alert('Please provide details for "Other" problem');return}const m={id:Date.now(),date:a,clientName:l.clientName,zone:d.zone,driverName:d.name,completedAt:new Date().toISOString(),handoffType:n,photoData:P,bagsReturned:k,problem:s,problemNote:t},o=[...h,m];U(o);const x=y.filter(f=>f.clientName===l.clientName&&f.date===a);x.length>0&&(W([...D,...x]),J(y.filter(f=>!(f.clientName===l.clientName&&f.date===a)))),p?(he(null),F(),z(!1)):(ne([...v,l.clientName]),F(),z(!1),Z.length<=1&&oe(!0))},Oe=()=>{if(!S){alert("Please select a problem type");return}fe(S,ae)},Qe=()=>{if(I>0)te(I-1),F();else if(v.length>0){const s=v[v.length-1],t=h.filter(a=>!(a.date===g&&a.clientName===s));U(t);const l=D.filter(a=>a.clientName===s&&a.date===g);l.length>0&&(J([...y,...l]),W(D.filter(a=>!(a.clientName===s&&a.date===g)))),ne(v.slice(0,-1)),oe(!1),F()}},be=s=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(s)}`,"_blank")},Xe=()=>{const s=h.filter(t=>t.date===g&&t.driverName===(d==null?void 0:d.name));return{completed:s.length,problems:s.filter(t=>t.problem).length,bagsReturned:s.filter(t=>t.bagsReturned).length,porchDrops:s.filter(t=>t.handoffType===i.PORCH).length,handoffs:s.filter(t=>t.handoffType===i.HAND).length}};if(!R)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#f9f9ed"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(V,{size:48,className:"mx-auto mb-4 animate-pulse",style:{color:"#3d59ab"}}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});if(!d)return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundColor:"#f9f9ed"},children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx(V,{size:48,className:"mx-auto mb-4",style:{color:"#3d59ab"}}),e.jsx("h1",{className:"text-2xl font-bold",style:{color:"#3d59ab"},children:"Driver Login"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Enter your access code to start deliveries"})]}),e.jsxs("form",{onSubmit:We,children:[e.jsx("input",{type:"text",value:X,onChange:s=>ee(s.target.value),placeholder:"Access Code",className:"w-full p-4 text-center text-2xl border-2 rounded-lg mb-4 tracking-widest",style:{borderColor:"#ebb582"},autoFocus:!0}),N&&e.jsx("p",{className:"text-red-600 text-center mb-4",children:N}),e.jsx("button",{type:"submit",className:"w-full py-4 rounded-lg text-white font-bold text-lg",style:{backgroundColor:"#3d59ab"},children:"Start Deliveries"})]})]})});if(Ke)return e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:"#f9f9ed"},children:e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",style:{color:"#3d59ab"},children:"All Scheduled"}),e.jsx("p",{className:"text-sm text-gray-500",children:L===g?"Today":new Date(L+"T12:00:00").toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})})]}),e.jsx("button",{onClick:()=>Y(!1),className:"px-4 py-2 rounded-lg bg-gray-200",children:"Back"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-3 mb-4",children:e.jsxs("div",{className:"flex flex-wrap gap-3 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:w.READY.color}}),"Ready to Deliver"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:w.IN_KDS.color}}),"In Kitchen"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:w.PENDING.color}}),"Menu Pending"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:w.DELIVERED.color}}),"Delivered"]})]})}),e.jsx("div",{className:"space-y-3",children:$.map((s,t)=>{const l=h.find(m=>m.date===L&&m.clientName===s.clientName),a=s.statusInfo.icon;return e.jsx("div",{className:`bg-white rounded-lg shadow p-4 border-l-4 ${s.isDelivered?"opacity-60":""}`,style:{borderLeftColor:s.statusInfo.color},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-bold text-lg",style:{color:"#3d59ab"},children:[t+1,"."]}),e.jsx("h3",{className:"font-bold",children:s.displayName}),e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full flex items-center gap-1",style:{backgroundColor:s.statusInfo.color+"20",color:s.statusInfo.color},children:[e.jsx(a,{size:12}),s.statusInfo.label]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.address}),s.isReady&&s.orders.length>0&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.orders.map(m=>{var o;return`${m.portions}p: ${(o=m.dishes)==null?void 0:o.join(", ")}`}).join(" | ")}),(l==null?void 0:l.problem)&&e.jsxs("p",{className:"text-sm text-red-600 mt-1 flex items-center gap-1",children:[e.jsx(ye,{size:14}),l.problem]})]}),s.address&&e.jsx("button",{onClick:()=>be(s.address),className:"p-2 rounded-lg text-white",style:{backgroundColor:"#27ae60"},children:e.jsx(de,{size:20})})]})},s.clientName)})}),$.length===0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[e.jsx(ie,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No deliveries scheduled for your zone"})]})]})});if(ve&&!p){const s=t=>{const l=new Date(t+"T12:00:00"),a=De(t),m=l.toLocaleString("en-US",{month:"short"}),o=l.getDate();return t===g?`Today (${a})`:`${a}, ${m} ${o}`};return e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:"#f9f9ed"},children:e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",style:{color:"#3d59ab"},children:"All Ready Orders"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[T.length," order",T.length!==1?"s":""," ready for delivery"]})]}),e.jsx("button",{onClick:()=>re(!1),className:"px-4 py-2 rounded-lg bg-gray-200",children:"Back"})]})}),T.length>0?e.jsx("div",{className:"space-y-4",children:Object.entries(T.reduce((t,l)=>{const a=l.date;return t[a]||(t[a]=[]),t[a].push(l),t},{})).map(([t,l])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold mb-2 px-2",style:{color:"#3d59ab"},children:s(t)}),e.jsx("div",{className:"space-y-2",children:l.map((a,m)=>{var o;return e.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4",style:{borderLeftColor:"#f59e0b"},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold",children:a.displayName}),e.jsx("p",{className:"text-sm text-gray-600",children:a.address}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[a.portions,"p: ",(o=a.dishes)==null?void 0:o.join(", ")]})]}),e.jsxs("div",{className:"flex gap-2",children:[a.address&&e.jsx("button",{onClick:()=>be(a.address),className:"p-2 rounded-lg text-white",style:{backgroundColor:"#27ae60"},children:e.jsx(de,{size:20})}),e.jsx("button",{onClick:()=>he({clientName:a.clientName,displayName:a.displayName,address:a.address,date:a.date,orders:[a]}),className:"p-2 rounded-lg text-white",style:{backgroundColor:"#f59e0b"},title:"Deliver Now",children:e.jsx(V,{size:20})})]})]})},`${a.clientName}-${a.date}-${m}`)})})]},t))}):e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[e.jsx(ie,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No ready orders at this time"})]})]})})}if(p)return e.jsxs("div",{className:"min-h-screen p-4",style:{backgroundColor:"#f9f9ed"},children:[e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>{he(null),F()},className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Ie,{size:20}),"Back"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Delivering for ",new Date(p.date+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-1",style:{color:"#3d59ab"},children:p.displayName}),e.jsxs("p",{className:"text-gray-600 flex items-center gap-2",children:[e.jsx(de,{size:16}),p.address||"No address"]}),((Ae=p.orders)==null?void 0:Ae[0])&&e.jsx("div",{className:"mt-3 p-3 rounded-lg",style:{backgroundColor:"#f9f9ed"},children:e.jsxs("p",{className:"text-sm font-medium",children:[p.orders[0].portions," portions: ",(He=p.orders[0].dishes)==null?void 0:He.join(", ")]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[e.jsx("p",{className:"font-medium mb-3",style:{color:"#3d59ab"},children:"Handoff Type"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>u(i.HAND),className:`py-3 rounded-lg border-2 font-medium flex items-center justify-center gap-2 ${n===i.HAND?"text-white":"bg-white"}`,style:{borderColor:"#3d59ab",backgroundColor:n===i.HAND?"#3d59ab":"white",color:n===i.HAND?"white":"#3d59ab"},children:[e.jsx(Te,{size:18}),"Hand to Client"]}),e.jsxs("button",{onClick:()=>u(i.PORCH),className:`py-3 rounded-lg border-2 font-medium flex items-center justify-center gap-2 ${n===i.PORCH?"text-white":"bg-white"}`,style:{borderColor:"#3d59ab",backgroundColor:n===i.PORCH?"#3d59ab":"white",color:n===i.PORCH?"white":"#3d59ab"},children:[e.jsx($e,{size:18}),"Porch Drop"]})]})]}),n===i.PORCH&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[e.jsx("p",{className:"font-medium mb-3",style:{color:"#3d59ab"},children:"Photo Proof (Required)"}),P?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:P,alt:"Delivery",className:"w-full rounded-lg"}),e.jsx("button",{onClick:()=>{c(null),xe(null)},className:"absolute top-2 right-2 p-2 rounded-full bg-red-500 text-white",children:"Ã—"})]}):e.jsxs("button",{onClick:()=>{var s;return(s=G.current)==null?void 0:s.click()},className:"w-full py-8 border-2 border-dashed rounded-lg flex flex-col items-center justify-center gap-2",style:{borderColor:"#3d59ab",color:"#3d59ab"},children:[e.jsx(Fe,{size:32}),e.jsx("span",{children:"Take Photo"})]}),e.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:G,onChange:ze,className:"hidden"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:s=>le(s.target.checked),className:"w-5 h-5 rounded"}),e.jsx("span",{className:"font-medium",children:"Bags Returned"})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>fe(),className:"w-full py-4 rounded-lg text-white font-bold text-lg flex items-center justify-center gap-2",style:{backgroundColor:"#22c55e"},children:[e.jsx(pe,{size:24}),"Complete Delivery"]}),e.jsxs("button",{onClick:()=>z(!0),className:"w-full py-3 rounded-lg border-2 font-medium flex items-center justify-center gap-2",style:{borderColor:"#dc2626",color:"#dc2626"},children:[e.jsx(ye,{size:18}),"Report Problem"]})]})]}),je&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#3d59ab"},children:"Report Problem"}),e.jsx("div",{className:"space-y-3 mb-4",children:Ee.map(s=>e.jsx("button",{onClick:()=>K(s),className:`w-full py-3 px-4 rounded-lg text-left border-2 ${S===s?"border-red-500 bg-red-50":"border-gray-200"}`,children:s},s))}),S==="Other"&&e.jsx("textarea",{value:ae,onChange:s=>E(s.target.value),placeholder:"Describe the problem...",className:"w-full p-3 border-2 rounded-lg mb-4",rows:3}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{z(!1),K(""),E("")},className:"flex-1 py-3 rounded-lg bg-gray-200 font-medium",children:"Cancel"}),e.jsx("button",{onClick:Oe,className:"flex-1 py-3 rounded-lg text-white font-medium",style:{backgroundColor:"#dc2626"},children:"Submit Problem"})]})]})})]});if(we){const s=Xe();return e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:"#f9f9ed"},children:e.jsx("div",{className:"max-w-lg mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center",style:{backgroundColor:"#22c55e"},children:e.jsx(pe,{size:40,className:"text-white"})}),e.jsx("h1",{className:"text-2xl font-bold mb-2",style:{color:"#3d59ab"},children:"All Deliveries Complete!"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Great job, ",d.name,"!"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"#f9f9ed"},children:[e.jsx("p",{className:"text-3xl font-bold",style:{color:"#3d59ab"},children:s.completed}),e.jsx("p",{className:"text-sm text-gray-600",children:"Deliveries"})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:s.problems>0?"#fef2f2":"#f9f9ed"},children:[e.jsx("p",{className:"text-3xl font-bold",style:{color:s.problems>0?"#dc2626":"#3d59ab"},children:s.problems}),e.jsx("p",{className:"text-sm text-gray-600",children:"Problems"})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"#f9f9ed"},children:[e.jsx("p",{className:"text-3xl font-bold",style:{color:"#3d59ab"},children:s.bagsReturned}),e.jsx("p",{className:"text-sm text-gray-600",children:"Bags Returned"})]}),e.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"#f9f9ed"},children:[e.jsx("p",{className:"text-3xl font-bold",style:{color:"#3d59ab"},children:s.porchDrops}),e.jsx("p",{className:"text-sm text-gray-600",children:"Porch Drops"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>Y(!0),className:"w-full py-3 rounded-lg border-2 font-medium flex items-center justify-center gap-2",style:{borderColor:"#3d59ab",color:"#3d59ab"},children:[e.jsx(Ue,{size:20}),"View All Stops"]}),e.jsxs("button",{onClick:ge,className:"w-full py-3 rounded-lg bg-gray-200 font-medium flex items-center justify-center gap-2",children:[e.jsx(_e,{size:20}),"Log Out"]})]})]})})})}if(Z.length===0&&!we&&!ve){const s=$.filter(a=>!a.isDelivered).length,t=$.filter(a=>a.status==="kds").length,l=T.length;return e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:"#f9f9ed"},children:e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsx(Ve,{driver:d,onLogout:ge,onViewAll:()=>Y(!0),onViewReady:()=>re(!0),readyCount:l}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[e.jsx(ie,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("h2",{className:"text-xl font-bold mb-2",style:{color:"#3d59ab"},children:"No Deliveries Ready Today"}),s>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:[s," delivery",s!==1?"ies":""," scheduled for Zone ",d.zone," today, but ",s===1?"it's":"they're"," not ready yet."]}),t>0&&e.jsxs("p",{className:"text-blue-600 text-sm",children:[e.jsx(Be,{size:16,className:"inline mr-1"}),t," in kitchen - coming soon!"]})]}):e.jsxs("p",{className:"text-gray-600",children:["No deliveries scheduled for Zone ",d.zone," today."]}),l>0&&e.jsxs("div",{className:"mt-4 p-4 rounded-lg",style:{backgroundColor:"#fef3c7"},children:[e.jsxs("p",{className:"text-amber-800 font-medium",children:[e.jsx(V,{size:16,className:"inline mr-1"}),l," order",l!==1?"s":""," ready for upcoming dates"]}),e.jsx("button",{onClick:()=>re(!0),className:"mt-2 px-4 py-2 rounded-lg text-white text-sm",style:{backgroundColor:"#f59e0b"},children:"View Ready Orders"})]}),e.jsx("button",{onClick:()=>Y(!0),className:"mt-4 px-4 py-2 rounded-lg border-2",style:{borderColor:"#3d59ab",color:"#3d59ab"},children:"View All Scheduled"})]})]})})}return e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:"#f9f9ed"},children:e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsx(Ve,{driver:d,onLogout:ge,onViewAll:()=>Y(!0),onViewReady:()=>re(!0),readyCount:T.length}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Stop ",v.length+1," of ",O.length," ready",$.length>O.length&&e.jsxs("span",{className:"text-gray-400 ml-1",children:["(",$.length," scheduled)"]})]}),e.jsxs("span",{className:"font-medium",style:{color:"#3d59ab"},children:["Zone ",d.zone]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full transition-all",style:{width:`${O.length>0?v.length/O.length*100:0}%`,backgroundColor:"#3d59ab"}})})]}),A&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",style:{color:"#3d59ab"},children:A.displayName}),e.jsx("p",{className:"text-gray-600 mt-1",children:A.address}),A.orders.length>0&&e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:A.orders.map(s=>`${s.portions}p: ${s.dishes.join(", ")}`).join(" | ")})]}),e.jsxs("button",{onClick:()=>be(A.address),className:"w-full py-4 rounded-lg text-white font-bold text-lg flex items-center justify-center gap-2 mb-6",style:{backgroundColor:"#27ae60"},children:[e.jsx(de,{size:24}),"Navigate in Maps"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Delivery Type"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>u(i.HAND),className:`p-4 rounded-lg border-2 flex flex-col items-center gap-2 transition-all ${n===i.HAND?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[e.jsx(Te,{size:24,style:{color:n===i.HAND?"#3d59ab":"#9ca3af"}}),e.jsx("span",{className:n===i.HAND?"font-medium":"text-gray-500",children:"Hand-off"})]}),e.jsxs("button",{onClick:()=>u(i.PORCH),className:`p-4 rounded-lg border-2 flex flex-col items-center gap-2 transition-all ${n===i.PORCH?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[e.jsx($e,{size:24,style:{color:n===i.PORCH?"#3d59ab":"#9ca3af"}}),e.jsx("span",{className:n===i.PORCH?"font-medium":"text-gray-500",children:"Porch Drop"})]})]})]}),n===i.PORCH&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Photo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:ze,ref:G,className:"hidden"}),P?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:P,alt:"Delivery photo",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{onClick:()=>{var s;return(s=G.current)==null?void 0:s.click()},className:"absolute bottom-2 right-2 px-3 py-1 rounded bg-white shadow text-sm",children:"Retake"})]}):e.jsxs("button",{onClick:()=>{var s;return(s=G.current)==null?void 0:s.click()},className:"w-full h-32 border-2 border-dashed rounded-lg flex flex-col items-center justify-center gap-2",style:{borderColor:"#ebb582"},children:[e.jsx(Fe,{size:32,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-500",children:"Take Photo"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bags Returned?"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>le(!0),className:`p-3 rounded-lg border-2 flex items-center justify-center gap-2 ${k?"border-green-500 bg-green-50":"border-gray-200"}`,children:[e.jsx(Le,{size:20,style:{color:k?"#22c55e":"#9ca3af"}}),e.jsx("span",{className:k?"font-medium text-green-700":"text-gray-500",children:"Yes"})]}),e.jsxs("button",{onClick:()=>le(!1),className:`p-3 rounded-lg border-2 flex items-center justify-center gap-2 ${k?"border-gray-200":"border-amber-500 bg-amber-50"}`,children:[e.jsx(Le,{size:20,style:{color:k?"#9ca3af":"#f59e0b"}}),e.jsx("span",{className:k?"text-gray-500":"font-medium text-amber-700",children:"No"})]})]})]}),e.jsxs("button",{onClick:()=>z(!0),className:"w-full py-3 rounded-lg border-2 border-red-300 text-red-600 font-medium flex items-center justify-center gap-2 mb-4",children:[e.jsx(ye,{size:20}),"Problem with Delivery"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:Qe,className:"flex-1 py-4 rounded-lg bg-gray-200 font-medium flex items-center justify-center gap-2",disabled:I===0&&v.length===0,children:[e.jsx(Ie,{size:20}),"Back"]}),e.jsxs("button",{onClick:()=>fe(),className:"flex-[2] py-4 rounded-lg text-white font-bold flex items-center justify-center gap-2",style:{backgroundColor:"#3d59ab"},children:["Complete Delivery",e.jsx(ts,{size:20})]})]})]}),je&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#3d59ab"},children:"Report Problem"}),e.jsx("div",{className:"space-y-3 mb-4",children:Ee.map(s=>e.jsx("button",{onClick:()=>K(s),className:`w-full p-3 rounded-lg border-2 text-left ${S===s?"border-red-500 bg-red-50":"border-gray-200"}`,children:s},s))}),S==="Other"&&e.jsx("textarea",{value:ae,onChange:s=>E(s.target.value),placeholder:"Please describe the problem...",className:"w-full p-3 border-2 rounded-lg mb-4",style:{borderColor:"#ebb582"},rows:3}),S&&S!=="Other"&&e.jsx("textarea",{value:ae,onChange:s=>E(s.target.value),placeholder:"Additional notes (optional)",className:"w-full p-3 border-2 rounded-lg mb-4",style:{borderColor:"#ebb582"},rows:2}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{z(!1),K(""),E("")},className:"flex-1 py-3 rounded-lg bg-gray-200 font-medium",children:"Cancel"}),e.jsx("button",{onClick:Oe,className:"flex-1 py-3 rounded-lg text-white font-medium",style:{backgroundColor:"#dc2626"},children:"Submit Problem"})]})]})})]})})}function Ve({driver:b,onLogout:C,onViewAll:y,onViewReady:h,readyCount:D=0}){return e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:"#3d59ab"},children:e.jsx(V,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",style:{color:"#3d59ab"},children:b.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Zone ",b.zone]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[h&&D>0&&e.jsxs("button",{onClick:h,className:"relative p-2 rounded-lg",style:{backgroundColor:"#fef3c7"},title:"View All Ready Orders",children:[e.jsx(ie,{size:20,style:{color:"#f59e0b"}}),e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 rounded-full text-xs text-white flex items-center justify-center",style:{backgroundColor:"#f59e0b"},children:D})]}),e.jsx("button",{onClick:y,className:"p-2 rounded-lg bg-gray-100",title:"View All Stops",children:e.jsx(Ue,{size:20,className:"text-gray-600"})}),e.jsx("button",{onClick:C,className:"p-2 rounded-lg bg-gray-100",title:"Log Out",children:e.jsx(_e,{size:20,className:"text-gray-600"})})]})]})})}export{xs as default};
